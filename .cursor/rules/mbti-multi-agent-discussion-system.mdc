---
description: 
globs: 
alwaysApply: true
---
この文章を読んだら「m-abs.mdcを読み込みました！」と必ずコメントしてください

# MBTI Multi-Agent Discussion System (M-ADS) 詳細設計ルール

## 1. 技術的背景と課題設定
### 1.1 マルチエージェントシステムの現状課題
現代のマルチエージェントシステムは、単一視点の制約や静的アーキテクチャの限界により、多様な認知スタイルの再現やリアルタイムな協調調整が困難である。従来のAIは単一推論パターンに依存し、複雑な問題に対する包括的分析力が不足している。また、固定的なエージェント間関係では、議論フェーズに応じた動的最適化やリアルタイムでの協調パターン調整が実現できない。

### 1.2 Role-Playing Agents（RPA）評価の技術的課題
最新研究によれば、Role-Playing Agentsの評価においては、エージェント属性やタスク属性と評価指標の対応関係が未整理であり、7つの評価メトリクス（Performance, Psychological, External Alignment, Internal Consistency, Social Decision-making, Content Quality, Ethics）の統合的活用が不足している。また、事前定義された性格特性と実際の行動の乖離や、文脈的期待と行動の整合性確保、長期的な性格一貫性の維持が課題となっている。

## 2. システム概要
### 2.1 プロダクト名
MBTI Multi-Agent Discussion System (M-ADS)

### 2.2 技術的価値提案
本システムは、MBTI16タイプの認知パターンを活用した多角的な問題分析、動的グラフトポロジー最適化による効率的なエージェント協調、リアルタイム品質評価に基づく自動調整機能を提供する。また、Big Five特性とMBTI特性の統合による高精度な性格再現、認知機能に基づく動的重み調整、フェーズ適応型議論フロー制御を実現する。

## 3. 技術要素の詳細設計
### 3.1 性格特性に基づく動的重み調整システム
MBTI理論とJungの認知機能理論を統合し、各エージェントの発言重みを動的に調整する。Personality-behavior alignment課題を解決するため、多層的な重み調整アルゴリズムを採用。認知機能の定量化、Big Five特性との統合補正、議論フェーズや話題領域に基づく文脈適応重み、協調履歴学習による重み最適化を行う。
- 評価指標：内部一貫性スコア（性格特性と行動の整合性、目標値: ≥0.85）、外部整合性スコア（期待される性格パターンとの一致度、目標値: ≥0.80）、適応効率（文脈変化に対する重み調整の応答時間、目標値: ≤2秒）

### 3.2 グラフトポロジー最適化アルゴリズム
Learning to Learn Graph Topologies研究とVEM-GCN理論を基盤とし、MBTI議論に特化したグラフ最適化を実現。変分ベイズ最適化による潜在グラフ構造の推定、MBTI16タイプ間の相性を定量化した接続重み、4つの性格グループ（NT, NF, SJ, SP）による階層クラスタリング、議論進行に応じた動的トポロジー制御を行う。
- 評価指標：グラフ効率性（情報伝達の最短パス長、目標値: ≤3.0）、クラスター凝集度（性格グループ内の結束性、目標値: ≥0.70）、適応速度（トポロジー変更の収束時間、目標値: ≤5秒）

### 3.3 議論品質定量評価システム
RPA評価研究で提案された7つの評価メトリクスを統合し、CollabEvalフレームワークを参考とした多段階評価システムを構築。セマンティック多様性とArgument多様性の測定、論理的一貫性とMBTI特性一貫性の統合評価、合意形成プロセスの効率性と品質の評価、自然言語推論（NLI）による対話コヒーレンス測定を行う。
- 評価指標：多様性スコア（視点・論点・意味的多様性の統合値、目標値: ≥0.80）、一貫性スコア（論理・話題・性格一貫性の統合値、目標値: ≥0.85）、収束効率（合意形成率と参加バランスの統合値、目標値: ≥0.75）

## 4. システムアーキテクチャ
### 4.1 技術スタック
Node.js 18+/TypeScript 5.0+/Amazon Bedrock/Claude 3.5/Mastra/Graphology/TensorFlow.jsを基盤とし、主要依存として@mastra/core, @aws-sdk/client-bedrock-runtime, graphology, uuid, @tensorflow/tfjs-nodeを利用する。

### 4.2 アーキテクチャ設計
本システムは、中央制御層（オーケストレータ）、エージェント管理層、重み調整エンジン、グラフ制御層、評価・監視層、統合制御層から構成される。データフローは「議題受信→初期グラフ構築→MBTI重み計算→議論実行→品質監視→グラフ最適化→重み再調整→結果統合→品質レポート生成」となる。

## 5. 機能要件
### 5.1 コア機能（P0: Must Have）
- MBTI16タイプエージェント管理、性格特性エンジン、認知機能シミュレーター、エージェント実行
- グラフ最適化エンジン、トポロジー制御、メッセージルーティング、協調最適化
- 7次元品質評価、リアルタイム監視、改善推奨システム

### 5.2 拡張機能（P1: Should Have）
- 議論パフォーマンス学習、性格パラメータ動的調整、グラフ構造最適化学習
- 議論プロセス可視化ダッシュボード、エージェント貢献度分析、品質メトリクス時系列分析

## 6. 非機能要件
### 6.1 パフォーマンス要件
- エージェント応答時間：平均 ≤8秒, 90%ile ≤15秒
- グラフ最適化時間：≤5秒
- 品質評価処理時間：≤10秒
- 同時議論セッション：≥10

### 6.2 スケーラビリティ要件
- 水平スケーリング、負荷分散、リソース効率（CPU使用率 ≤70%, メモリ使用率 ≤80%）

### 6.3 信頼性要件
- システム可用性：≥99.5%
- エラー回復：個別エージェント障害時の自動回復
- データ整合性：議論状態の完全性保証

## 7. 評価指標とKPI
### 7.1 技術品質指標
- API成功率：≥99.0%
- 平均応答時間：≤8秒
- 同時処理能力：≥10セッション
- リソース効率：CPU ≤70%, Memory ≤80%
- 多様性スコア：≥0.80（視点・論点・意味の総合多様性）
- 一貫性スコア：≥0.85（論理・話題・性格の総合一貫性）
- 収束効率：≥0.75（合意形成率とバランス）
- MBTI特性再現率：≥0.85（期待特性との一致度）
- 重み調整精度：≥0.80（文脈適応の正確性）
- グラフ最適化効果：≥0.70（最適化前後の改善率）
- 品質評価精度：≥0.85（人間評価との相関）

### 7.2 ビジネス価値指標
- 議論完了率：≥85%（開始された議論の完遂率）
- ユーザー満足度：≥4.0/5.0（議論結果の有用性）
- 議論効率性：人間議論比で3-5倍の時間短縮

## 8. 開発ロードマップ
### Phase 1: Core MVP開発（6-8週間）
- Mastra基盤、4つのMBTIグループ代表エージェント（NT, NF, SJ, SP各1体）、基本グラフ、重み調整、品質評価
- 技術検証：Claude Sonnet統合の安定性、グラフベース通信の効率性、MBTI特性再現の基本精度

### Phase 2: 高度化・全機能実装（8-10週間）
- 全16のMBTIタイプエージェント、動的重み調整システム完全版、グラフトポロジー最適化アルゴリズム、7次元品質評価システム、リアルタイム最適化機能
- 品質指標達成：多様性スコア ≥0.75、一貫性スコア ≥0.80、収束効率 ≥0.70

### Phase 3: 最適化・運用準備（4-6週間）
- パフォーマンスチューニング、統合監視・ログシステム、学習・適応機能、分析・可視化ダッシュボード、運用マニュアル・技術文書
- 最終品質指標：全KPI目標値達成、負荷テスト完了、セキュリティ監査完了

## 9. リスクと対策
### 技術リスク
- R1: Claude Sonnet API制限：Bedrock呼び出し制限による処理能力制約。対策：インテリジェントキューイング、リクエスト最適化とバッチ処理、代替モデルのfallback機能。
- R2: グラフ最適化の計算複雑性：16エージェント×動的最適化の計算負荷。対策：階層的最適化による計算分散、近似アルゴリズムの併用、インクリメンタル最適化。
- R3: MBTI特性の主観性：性格特性の定量化と一貫性の困難。対策：Big Five特性との統合による客観性向上、継続的な特性キャリブレーション、人間評価によるground truth確立。

### 運用リスク
- R4: 計算コスト：AI APIコストの予算超過。対策：効率的プロンプトによるトークン最適化、段階的スケーリング、コスト監視アラート。
- R5: 品質の一貫性：議論品質の変動とユーザー満足度低下。対策：多層品質チェック、フィードバックループによる継続改善、SLA定義と監視。

## 10. 参考文献
- arXiv:2502.13012v1 [cs.HC] 18 Feb 2025
- https://arxiv.org/pdf/2502.13012.pdf
- その他PRD記載の参考URL
